## D. Christmas Tree

### 题目描述

There are $n$ light bulbs on the Christmas
tree, connected by $(n - 1)$ wires. Each wire
connects two different bulbs, forming a tree rooted at the $1$-st bulb. Initially, the beauty of the
Christmas tree is $0$, and you can light up
some bulbs to increase the beauty.Lighting up the $i$-th bulb consumes $a_i$ units of power and increases the beauty
by $b_i$. Due to the heat generated by the
wire, for the $j$-th wire, if both the $u_j$-th bulb and the $v_j$-th bulb it connects are lit, an
additional $c_j$ units of power will be
consumed. Since lit bulbs also generate heat, for safety reasons, each
lit bulb must be directly connected by a wire to at least one unlit
bulb.There is a power meter with a range of $m$,
which shows the total power consumption in modulo $m$. There are$q$ queries, each providing $r$ and $k$, and you need to find the maximum beauty
of the Christmas tree when only lighting up bulbs in the subtree rooted
at the $r$-th bulb, keeping bulbs outside the
subtree unlit, and the power meter shows $k$,
as well as the number of ways to light up the bulbs that can achieve the
maximum beauty.Two ways to light up the bulbs are considered different if and only if
there exists at least one bulb that is lit in one way but not in the
other. Since the number of ways may be large, you just need to output it
modulo $(10^9 + 7)$. If there is no feasible
way, the maximum beauty is considered to be $-1$, and the number of ways is $0$.

### 输入描述

The first line contains three integers $n$, $m$ and$q$ ($1 \leq n \leq 100$, $1 \leq m \leq 3 \times 10^4$, $1 \leq q \leq 10^5$), indicating the number
of bulbs on the Christmas tree, the range of the power meter, and the
number of queries.Then $n$ lines follow, the $i$-th of which contains two integers $a_i$ and$b_i$ ($1 \leq a_i, b_i \leq 10^6$), indicating
that lighting up the $i$-th bulb consumes $a_i$ units of power and increases the beauty
by $b_i$.Then $(n - 1)$ lines follow, the $j$-th of which contains three integers $u_j$, $v_j$ and$c_j$ ($1 \leq u_i, v_j \leq n$, $1 \leq c_j \leq 10^6$), indicating that the $j$-th wire connects the $u_j$-th bulb and the $v_j$-th bulb, and if these bulbs are both
lit, an additional $c_j$ units of power will
be consumed. It is guaranteed that the input wires connect all bulbs
forming a tree.Then $q$ lines follow, each of which contains
two integers $r$ and$k$ ($1 \leq r \leq n$, $0 \leq k < m$), indicating a query.

### 输出描述

Output $q$ lines, each of which contains two
integers, indicating the maximum beauty of the Christmas tree when only
lighting up bulbs in the subtree rooted at the $r$-th bulb, keeping bulbs outside the
subtree unlit, and the power meter shows $k$,
as well as the number of ways to light up the bulbs that achieve the
maximum beauty, in modulo $(10^9 + 7)$. If
there is no feasible way, the maximum beauty is considered to be $-1$, and the number of ways is $0$.

### 示例1

#### 输入

```plain
4 4 4
1 1
2 2
3 3
4 4
1 2 1
1 3 2
2 4 3
1 0
1 1
1 2
1 3
```

#### 输出

```plain
4 1
5 2
2 1
7 1
```

### 示例2

#### 输入

```plain
1 2 2
1 1
1 0
1 1
```

#### 输出

```plain
0 1
-1 0
```

#### 说明

In the second sample case, a single bulb cannot be lit.

