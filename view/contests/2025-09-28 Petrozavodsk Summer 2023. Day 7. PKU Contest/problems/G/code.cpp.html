<!DOCTYPE html><!--7MBbGvaYym9JmYuGzqZKq--><html lang="en"><head><meta charSet="UTF-8"/><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/Training-Archive/_next/static/media/cc27cf3ff100ea21-s.p.ttf" as="font" crossorigin="" type="font/ttf"/><link rel="stylesheet" href="/Training-Archive/_next/static/css/f46a16dd4ad90ea1.css" data-precedence="next"/><link rel="stylesheet" href="/Training-Archive/_next/static/css/9f4210e542df69af.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/Training-Archive/_next/static/chunks/webpack-12683b4c0beed4e8.js"/><script src="/Training-Archive/_next/static/chunks/6ae3b393-4b033cbd06089d1e.js" async=""></script><script src="/Training-Archive/_next/static/chunks/255-1436767215191b46.js" async=""></script><script src="/Training-Archive/_next/static/chunks/main-app-e0c5a520a19df54e.js" async=""></script><script src="/Training-Archive/_next/static/chunks/1951f239-e4c7a40f4938f7cd.js" async=""></script><script src="/Training-Archive/_next/static/chunks/903-580aa120588c94fd.js" async=""></script><script src="/Training-Archive/_next/static/chunks/314-bdd16cf32a728af3.js" async=""></script><script src="/Training-Archive/_next/static/chunks/app/view/contests/%5Bcontest%5D/problems/%5Bproblem%5D/%5Bfile%5D/page-45187987e20c318a.js" async=""></script><link rel="icon" type="image/png" href="https://appleblue17.github.io/Training-Archive/archive-bot.png"/><title>Training Archive</title><meta name="next-size-adjust" content=""/><script src="/Training-Archive/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__className_e3f162 antialiased"><div hidden=""><!--$--><!--/$--></div><div class="flex min-h-screen justify-center py-4"><div class="mx-auto w-4/5"><header class="relative w-full rounded-lg py-2 text-slate-300"><a href="/Training-Archive"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="absolute -left-10 top-3 size-6 transition-colors hover:text-gray-400" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg></a><h1 class="text-2xl font-semibold tracking-wide">File Viewer</h1><p class="ml-4 mt-2 text-base text-gray-400"><span class="px-2 text-lg text-gray-200">/</span>2025-09-28 Petrozavodsk Summer 2023. Day 7. PKU Contest<span class="px-2 text-lg text-slate-300">/</span>G<span class="px-2 text-lg text-slate-300">/</span>code.cpp</p><div class="absolute right-8 top-2 flex items-center gap-2"><a href="/Training-Archive/contests/2025-09-28 Petrozavodsk Summer 2023. Day 7. PKU Contest/problems/G/code.cpp" download="" class="rounded bg-gray-700 px-3 py-1 text-sm text-white hover:bg-gray-600"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="mr-2 inline-block text-base" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>Download</a><a href="/Training-Archive/contests/2025-09-28 Petrozavodsk Summer 2023. Day 7. PKU Contest/problems/G/code.cpp" target="_blank" rel="noopener noreferrer" class="rounded bg-gray-700 px-3 py-1 text-sm text-white hover:bg-gray-600"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="mr-2 inline-block text-base" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>Raw File</a></div></header><main class="mt-4 flex w-full items-start justify-center gap-4"><div class="flex-grow"><div class="relative flex h-[85dvh] w-[62dvw] max-w-full rounded border-2 border-gray-600 bg-zinc-900"><button class="absolute right-6 top-4 z-10 rounded bg-gray-700 px-3 py-1 text-sm text-white hover:bg-gray-600"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="mr-1 inline-block" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>Copy</button><div class="relative flex-1 overflow-y-auto"><div class="absolute left-4 top-0"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="mr-1 inline-block text-gray-200" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg><span class="text-sm text-gray-400">cpp</span></div><div class="flex-1 py-5"><pre style="display:block;overflow-x:auto;padding:0.5em;color:#abb2bf;background:transparent"><code class="language-cpp" style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">1</span><span style="color:#61aeee">#</span><span class="hljs-meta-keyword" style="color:#61aeee">include</span><span style="color:#98c379">&lt;bits/stdc++.h&gt;</span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">2</span><span></span><span style="color:#c678dd">using</span><span> </span><span style="color:#c678dd">namespace</span><span> std;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">3</span><span></span><span style="color:#c678dd">typedef</span><span> </span><span style="color:#c678dd">long</span><span> </span><span style="color:#c678dd">long</span><span> ll;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">4</span><span></span><span style="color:#c678dd">typedef</span><span> </span><span style="color:#c678dd">double</span><span> dou;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">5</span><span></span><span style="color:#c678dd">typedef</span><span> pair&lt;</span><span style="color:#c678dd">int</span><span>,</span><span style="color:#c678dd">int</span><span>&gt; pii;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">6</span><span></span><span style="color:#61aeee">#</span><span class="hljs-meta-keyword" style="color:#61aeee">define</span><span style="color:#61aeee"> fi first</span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">7</span><span></span><span style="color:#61aeee">#</span><span class="hljs-meta-keyword" style="color:#61aeee">define</span><span style="color:#61aeee"> se second</span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">8</span><span></span><span style="color:#61aeee">#</span><span class="hljs-meta-keyword" style="color:#61aeee">define</span><span style="color:#61aeee"> mapa make_pair</span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">9</span><span></span><span style="color:#c678dd">typedef</span><span> </span><span style="color:#c678dd">long</span><span> </span><span style="color:#c678dd">double</span><span> ld;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">10</span><span></span><span style="color:#c678dd">typedef</span><span> </span><span style="color:#c678dd">unsigned</span><span> </span><span style="color:#c678dd">long</span><span> </span><span style="color:#c678dd">long</span><span> ull;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">11</span><span></span><span style="color:#61aeee">#</span><span class="hljs-meta-keyword" style="color:#61aeee">define</span><span style="color:#61aeee"> ep emplace_back</span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">12</span><span></span><span style="color:#c678dd">template</span><span> &lt;</span><span style="color:#c678dd">typename</span><span> T&gt;</span><span class="hljs-function" style="color:#c678dd">inline</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#c678dd">void</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">read</span><span class="hljs-function hljs-params">(T &amp;x)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">13</span><span>	x=</span><span style="color:#d19a66">0</span><span>;</span><span style="color:#c678dd">char</span><span> c=</span><span style="color:#e6c07b">getchar</span><span>();</span><span style="color:#c678dd">bool</span><span> f=</span><span style="color:#d19a66">0</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">14</span><span>	</span><span style="color:#c678dd">for</span><span>(;c&lt;</span><span style="color:#98c379">&#x27;0&#x27;</span><span>||c&gt;</span><span style="color:#98c379">&#x27;9&#x27;</span><span>;c=</span><span style="color:#e6c07b">getchar</span><span>()) f|=(c==</span><span style="color:#98c379">&#x27;-&#x27;</span><span>);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">15</span><span>	</span><span style="color:#c678dd">for</span><span>(;c&gt;=</span><span style="color:#98c379">&#x27;0&#x27;</span><span>&amp;&amp;c&lt;=</span><span style="color:#98c379">&#x27;9&#x27;</span><span>;c=</span><span style="color:#e6c07b">getchar</span><span>())
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">16</span><span>	x=(x&lt;&lt;</span><span style="color:#d19a66">1</span><span>)+(x&lt;&lt;</span><span style="color:#d19a66">3</span><span>)+(c^</span><span style="color:#d19a66">48</span><span>);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">17</span>	x=(f?-x:x);
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">18</span>}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">19</span><span></span><span style="color:#c678dd">const</span><span> </span><span style="color:#c678dd">int</span><span> N=</span><span style="color:#d19a66">1e5</span><span>+</span><span style="color:#d19a66">5</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">20</span><span></span><span style="color:#c678dd">int</span><span> T, n, m;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">21</span><span></span><span style="color:#c678dd">int</span><span> ans[N];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">22</span><span>vector&lt;</span><span style="color:#c678dd">int</span><span>&gt; e[N];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">23</span><span></span><span class="hljs-class" style="color:#c678dd">struct</span><span class="hljs-class"> </span><span class="hljs-class" style="color:#61aeee">Neighbors</span><span class="hljs-class">{</span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">24</span><span>    </span><span style="color:#c678dd">bool</span><span> v[N];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">25</span><span>    </span><span class="hljs-function" style="color:#c678dd">int</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">get_s</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> x, </span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> fa)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">26</span><span>        </span><span style="color:#c678dd">if</span><span>(v[x]) </span><span style="color:#c678dd">return</span><span> </span><span style="color:#d19a66">0</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">27</span><span>        </span><span style="color:#c678dd">int</span><span> ret=</span><span style="color:#d19a66">1</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">28</span><span>        </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">auto</span><span> y:e[x]) </span><span style="color:#c678dd">if</span><span>(y!=fa) 
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">29</span><span>            ret+=</span><span style="color:#e6c07b">get_s</span><span>(y, x);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">30</span><span>        </span><span style="color:#c678dd">return</span><span> ret;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">31</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">32</span><span>    </span><span class="hljs-function" style="color:#c678dd">int</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">get_rt</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> x, </span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> fa, </span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> siz, </span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> &amp;rt)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">33</span><span>        </span><span style="color:#c678dd">if</span><span>(v[x]) </span><span style="color:#c678dd">return</span><span> </span><span style="color:#d19a66">0</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">34</span><span>        </span><span style="color:#c678dd">int</span><span> sum=</span><span style="color:#d19a66">1</span><span>, mx=</span><span style="color:#d19a66">0</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">35</span><span>        </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">auto</span><span> y:e[x]){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">36</span><span>            </span><span style="color:#c678dd">if</span><span>(y==fa) </span><span style="color:#c678dd">continue</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">37</span><span>            </span><span style="color:#c678dd">int</span><span> t=</span><span style="color:#e6c07b">get_rt</span><span>(y, x, siz, rt);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">38</span><span>            mx=</span><span style="color:#e6c07b">max</span><span>(mx,t); sum+=t;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">39</span>        }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">40</span><span>        mx=</span><span style="color:#e6c07b">max</span><span>(mx, siz-sum);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">41</span><span>        </span><span style="color:#c678dd">if</span><span>(mx&lt;=siz/</span><span style="color:#d19a66">2</span><span>) rt=x;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">42</span><span>        </span><span style="color:#c678dd">return</span><span> sum;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">43</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">44</span><span>    </span><span style="color:#c678dd">int</span><span> rt, fa[N];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">45</span><span>    </span><span class="hljs-function" style="color:#c678dd">void</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">devide</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> x)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">46</span><span>        v[x]=</span><span style="color:#d19a66">1</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">47</span><span>        </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">auto</span><span> y:e[x]){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">48</span><span>            </span><span style="color:#c678dd">if</span><span>(v[y]) </span><span style="color:#c678dd">continue</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">49</span><span>            </span><span style="color:#c678dd">int</span><span> nrt=</span><span style="color:#d19a66">-1</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">50</span><span>            </span><span style="color:#e6c07b">get_rt</span><span>(y, </span><span style="color:#d19a66">-1</span><span>, </span><span style="color:#e6c07b">get_s</span><span>(y, </span><span style="color:#d19a66">-1</span><span>), nrt); </span><span style="color:#e6c07b">devide</span><span>(nrt); fa[nrt]=x;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">51</span>        }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">52</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">53</span><span>    </span><span style="color:#c678dd">int</span><span> dfn, st[</span><span style="color:#d19a66">20</span><span>][N&lt;&lt;</span><span style="color:#d19a66">1</span><span>], pos[N], lg[N&lt;&lt;</span><span style="color:#d19a66">1</span><span>], dep[N];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">54</span><span>    </span><span class="hljs-function" style="color:#c678dd">void</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">dis_pre</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> x, </span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> fa, </span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> cd)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">55</span><span>        st[</span><span style="color:#d19a66">0</span><span>][++dfn]=x; pos[x]=dfn; dep[x]=cd;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">56</span><span>        </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">auto</span><span> y:e[x]){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">57</span><span>            </span><span style="color:#c678dd">if</span><span>(y==fa) </span><span style="color:#c678dd">continue</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">58</span><span>            </span><span style="color:#e6c07b">dis_pre</span><span>(y, x, cd+</span><span style="color:#d19a66">1</span><span>);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">59</span><span>            st[</span><span style="color:#d19a66">0</span><span>][++dfn]=x;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">60</span>        }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">61</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">62</span><span>    </span><span class="hljs-function" style="color:#c678dd">void</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">lca_pre</span><span class="hljs-function hljs-params">()</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">63</span><span>        </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=</span><span style="color:#d19a66">2</span><span>; i&lt;=dfn; i++) lg[i]=lg[i&gt;&gt;</span><span style="color:#d19a66">1</span><span>]+</span><span style="color:#d19a66">1</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">64</span><span>        </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=</span><span style="color:#d19a66">1</span><span>; i&lt;=lg[dfn]; i++){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">65</span><span>            </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> j=</span><span style="color:#d19a66">1</span><span>; j+(</span><span style="color:#d19a66">1</span><span>&lt;&lt;i)</span><span style="color:#d19a66">-1</span><span>&lt;=dfn; j++){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">66</span><span>                st[i][j]=dep[st[i</span><span style="color:#d19a66">-1</span><span>][j]]&lt;dep[st[i</span><span style="color:#d19a66">-1</span><span>][j+(</span><span style="color:#d19a66">1</span><span>&lt;&lt;(i</span><span style="color:#d19a66">-1</span><span>))]]?
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">67</span><span>                st[i</span><span style="color:#d19a66">-1</span><span>][j]:st[i</span><span style="color:#d19a66">-1</span><span>][j+(</span><span style="color:#d19a66">1</span><span>&lt;&lt;(i</span><span style="color:#d19a66">-1</span><span>))];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">68</span>            }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">69</span>        }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">70</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">71</span><span>    </span><span class="hljs-function" style="color:#c678dd">int</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">lca</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> x, </span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> y)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">72</span>        x=pos[x], y=pos[y];
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">73</span><span>        </span><span style="color:#c678dd">if</span><span>(x&gt;y) </span><span style="color:#e6c07b">swap</span><span>(x, y);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">74</span><span>        </span><span style="color:#c678dd">int</span><span> t=lg[y-x+</span><span style="color:#d19a66">1</span><span>];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">75</span><span>        </span><span style="color:#c678dd">return</span><span> dep[st[t][x]]&lt;dep[st[t][y-(</span><span style="color:#d19a66">1</span><span>&lt;&lt;t)+</span><span style="color:#d19a66">1</span><span>]]?
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">76</span><span>        st[t][x]:st[t][y-(</span><span style="color:#d19a66">1</span><span>&lt;&lt;t)+</span><span style="color:#d19a66">1</span><span>];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">77</span>    } 
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">78</span><span>    </span><span class="hljs-function" style="color:#c678dd">int</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">get_dis</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> x, </span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> y)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">79</span><span>        </span><span style="color:#c678dd">return</span><span> dep[x]+dep[y]</span><span style="color:#d19a66">-2</span><span>*dep[</span><span style="color:#e6c07b">lca</span><span>(x, y)];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">80</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">81</span><span>    vector&lt;</span><span style="color:#c678dd">int</span><span>&gt; item[</span><span style="color:#d19a66">2</span><span>][N];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">82</span><span>    </span><span class="hljs-function" style="color:#c678dd">void</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">ins</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> x)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">83</span><span>        </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=x; i; i=fa[i]){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">84</span><span>            item[</span><span style="color:#d19a66">0</span><span>][i].</span><span style="color:#e6c07b">ep</span><span>(</span><span style="color:#e6c07b">get_dis</span><span>(x, i));
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">85</span><span>            </span><span style="color:#c678dd">if</span><span>(fa[i]) {
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">86</span><span>                item[</span><span style="color:#d19a66">1</span><span>][i].</span><span style="color:#e6c07b">ep</span><span>(</span><span style="color:#e6c07b">get_dis</span><span>(x, fa[i]));
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">87</span>            }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">88</span>        }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">89</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">90</span><span>    </span><span class="hljs-function" style="color:#c678dd">int</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">get</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> x, </span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> k)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">91</span><span>        </span><span style="color:#c678dd">int</span><span> ret=</span><span style="color:#d19a66">0</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">92</span><span>        </span><span style="color:#c678dd">int</span><span> pre=</span><span style="color:#d19a66">0</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">93</span><span>        </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=x; i; pre=i, i=fa[i]){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">94</span><span>            </span><span style="color:#c678dd">int</span><span> len=k-</span><span style="color:#e6c07b">get_dis</span><span>(x, i);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">95</span><span>            </span><span style="color:#c678dd">if</span><span>(len&lt;</span><span style="color:#d19a66">0</span><span>) </span><span style="color:#c678dd">continue</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">96</span><span>            ret+=</span><span style="color:#e6c07b">upper_bound</span><span>(item[</span><span style="color:#d19a66">0</span><span>][i].</span><span style="color:#e6c07b">begin</span><span>(), item[</span><span style="color:#d19a66">0</span><span>][i].</span><span style="color:#e6c07b">end</span><span>(), len)-item[</span><span style="color:#d19a66">0</span><span>][i].</span><span style="color:#e6c07b">begin</span><span>();
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">97</span><span>            </span><span style="color:#c678dd">if</span><span>(pre) ret-=</span><span style="color:#e6c07b">upper_bound</span><span>(item[</span><span style="color:#d19a66">1</span><span>][pre].</span><span style="color:#e6c07b">begin</span><span>(), item[</span><span style="color:#d19a66">1</span><span>][pre].</span><span style="color:#e6c07b">end</span><span>(), len)-item[</span><span style="color:#d19a66">1</span><span>][pre].</span><span style="color:#e6c07b">begin</span><span>();
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">98</span>        }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">99</span><span>        </span><span style="color:#c678dd">return</span><span> ret;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">100</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">101</span><span>    </span><span class="hljs-function" style="color:#c678dd">void</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">build</span><span class="hljs-function hljs-params">()</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">102</span><span>        dfn=</span><span style="color:#d19a66">0</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">103</span><span>        </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=</span><span style="color:#d19a66">1</span><span>; i&lt;=n; ++i) v[i]=</span><span style="color:#d19a66">0</span><span>, item[</span><span style="color:#d19a66">0</span><span>][i].</span><span style="color:#e6c07b">clear</span><span>(), item[</span><span style="color:#d19a66">1</span><span>][i].</span><span style="color:#e6c07b">clear</span><span>();
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">104</span><span>        </span><span style="color:#e6c07b">get_rt</span><span>(</span><span style="color:#d19a66">1</span><span>, </span><span style="color:#d19a66">-1</span><span>, n, rt);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">105</span><span>        fa[rt]=</span><span style="color:#d19a66">0</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">106</span><span>        </span><span style="color:#e6c07b">devide</span><span>(rt);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">107</span><span>        </span><span style="color:#e6c07b">dis_pre</span><span>(rt, </span><span style="color:#d19a66">-1</span><span>, </span><span style="color:#d19a66">1</span><span>);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">108</span><span>        </span><span style="color:#e6c07b">lca_pre</span><span>();
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">109</span><span>        </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=</span><span style="color:#d19a66">1</span><span>; i&lt;=n; ++i) </span><span style="color:#e6c07b">ins</span><span>(i);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">110</span><span>        </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=</span><span style="color:#d19a66">1</span><span>; i&lt;=n; ++i) </span><span style="color:#e6c07b">sort</span><span>(item[</span><span style="color:#d19a66">0</span><span>][i].</span><span style="color:#e6c07b">begin</span><span>(), item[</span><span style="color:#d19a66">0</span><span>][i].</span><span style="color:#e6c07b">end</span><span>()), </span><span style="color:#e6c07b">sort</span><span>(item[</span><span style="color:#d19a66">1</span><span>][i].</span><span style="color:#e6c07b">begin</span><span>(), item[</span><span style="color:#d19a66">1</span><span>][i].</span><span style="color:#e6c07b">end</span><span>());
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">111</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">112</span>}D1;
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">113</span><span></span><span class="hljs-class" style="color:#c678dd">struct</span><span class="hljs-class"> </span><span class="hljs-class" style="color:#61aeee">Neighbors2</span><span class="hljs-class">{</span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">114</span><span>    </span><span class="hljs-class" style="color:#c678dd">struct</span><span class="hljs-class"> </span><span class="hljs-class" style="color:#61aeee">node</span><span class="hljs-class">{</span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">115</span><span>        </span><span style="color:#c678dd">int</span><span> id, k, mul;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">116</span>    };
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">117</span><span>    </span><span style="color:#c678dd">int</span><span> dfn[N], son[N], seq[N], top[N], len[N], sz[N], f[N], dep[N];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">118</span><span>    </span><span style="color:#c678dd">int</span><span> timer;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">119</span>    vector&lt;node&gt; qry[N];
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">120</span><span>    </span><span class="hljs-function" style="color:#c678dd">void</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">dfs</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> x, </span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> fa)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">121</span><span>        f[x]=fa; sz[x]=</span><span style="color:#d19a66">1</span><span>; son[x]=</span><span style="color:#d19a66">0</span><span>; dep[x]=dep[fa]+</span><span style="color:#d19a66">1</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">122</span><span>        </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">auto</span><span> y:e[x]) </span><span style="color:#c678dd">if</span><span>(y^fa){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">123</span><span>            </span><span style="color:#e6c07b">dfs</span><span>(y, x);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">124</span>            sz[x]+=sz[y];
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">125</span><span>            </span><span style="color:#c678dd">if</span><span>(sz[y]&gt;sz[son[x]]) son[x]=y;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">126</span>        }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">127</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">128</span><span>    </span><span class="hljs-function" style="color:#c678dd">void</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">dfs2</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> x, </span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> tp)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">129</span>        top[x]=tp; ++len[tp]; dfn[x]=++timer; seq[timer]=x;
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">130</span><span>        </span><span style="color:#c678dd">if</span><span>(son[x]) </span><span style="color:#e6c07b">dfs2</span><span>(son[x], tp);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">131</span><span>        </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">auto</span><span> y:e[x]) </span><span style="color:#c678dd">if</span><span>(y!=f[x]&amp;&amp;y!=son[x]){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">132</span><span>            len[y]=</span><span style="color:#d19a66">0</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">133</span><span>            </span><span style="color:#e6c07b">dfs2</span><span>(y, y);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">134</span>        }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">135</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">136</span><span>    </span><span class="hljs-function" style="color:#c678dd">void</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">build</span><span class="hljs-function hljs-params">()</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">137</span><span>        </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=</span><span style="color:#d19a66">1</span><span>; i&lt;=n; ++i) qry[i].</span><span style="color:#e6c07b">clear</span><span>();
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">138</span><span>        timer=</span><span style="color:#d19a66">0</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">139</span><span>        </span><span style="color:#e6c07b">dfs</span><span>(</span><span style="color:#d19a66">1</span><span>, </span><span style="color:#d19a66">0</span><span>);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">140</span><span>        len[</span><span style="color:#d19a66">1</span><span>]=</span><span style="color:#d19a66">0</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">141</span><span>        </span><span style="color:#e6c07b">dfs2</span><span>(</span><span style="color:#d19a66">1</span><span>, </span><span style="color:#d19a66">1</span><span>);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">142</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">143</span><span>    </span><span class="hljs-function" style="color:#c678dd">void</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">ins</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> x, node tem)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">144</span><span>        </span><span style="color:#c678dd">while</span><span>(x){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">145</span><span>            qry[x].</span><span style="color:#e6c07b">ep</span><span>(tem);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">146</span>            x=f[top[x]];
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">147</span>        }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">148</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">149</span><span>    </span><span style="color:#c678dd">int</span><span> tr[N&lt;&lt;</span><span style="color:#d19a66">1</span><span>];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">150</span>    vector&lt;pii&gt; back;
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">151</span><span>    </span><span class="hljs-function" style="color:#c678dd">void</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">add</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> x, </span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> v, </span><span class="hljs-function hljs-params" style="color:#c678dd">bool</span><span class="hljs-function hljs-params"> flag)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">152</span><span>        </span><span style="color:#c678dd">if</span><span>(flag) back.</span><span style="color:#e6c07b">ep</span><span>(x, -v);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">153</span>        ++x;
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">154</span><span>        </span><span style="color:#c678dd">for</span><span>(; x&lt;=n*</span><span style="color:#d19a66">2</span><span>; x+=(x&amp;-x)) tr[x]+=v;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">155</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">156</span><span>    </span><span class="hljs-function" style="color:#c678dd">int</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">get</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> x)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">157</span><span>        </span><span style="color:#c678dd">int</span><span> ret=</span><span style="color:#d19a66">0</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">158</span><span>        </span><span style="color:#c678dd">for</span><span>(x=</span><span style="color:#e6c07b">min</span><span>(x+</span><span style="color:#d19a66">1</span><span>, n*</span><span style="color:#d19a66">2</span><span>); x&gt;</span><span style="color:#d19a66">0</span><span>; x-=(x&amp;-x)) ret+=tr[x];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">159</span><span>        </span><span style="color:#c678dd">return</span><span> ret;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">160</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">161</span><span>    </span><span class="hljs-function" style="color:#c678dd">void</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">solve</span><span class="hljs-function hljs-params">()</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">162</span><span>        </span><span style="color:#5c6370;font-style:italic">//calculated at lca exactly once</span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">163</span><span>        </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=</span><span style="color:#d19a66">1</span><span>; i&lt;=n; ++i) </span><span style="color:#c678dd">if</span><span>(i==top[i]){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">164</span><span>            </span><span style="color:#5c6370;font-style:italic">//</span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">165</span><span>            </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> j=</span><span style="color:#d19a66">0</span><span>; j&lt;len[i]; ++j){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">166</span><span>                </span><span style="color:#c678dd">int</span><span> x=seq[dfn[i]+j];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">167</span><span>                </span><span style="color:#5c6370;font-style:italic">//i&#x27;s subtree </span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">168</span><span>                </span><span style="color:#e6c07b">add</span><span>(</span><span style="color:#d19a66">0</span><span>, </span><span style="color:#d19a66">1</span><span>, </span><span style="color:#d19a66">1</span><span>); 
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">169</span><span>                </span><span style="color:#5c6370;font-style:italic">//i&#x27;s father</span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">170</span><span>                </span><span style="color:#e6c07b">add</span><span>(dep[x]-dep[i]+</span><span style="color:#d19a66">1</span><span>, </span><span style="color:#d19a66">-1</span><span>, </span><span style="color:#d19a66">1</span><span>);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">171</span><span>                </span><span style="color:#c678dd">if</span><span>(son[x]){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">172</span><span>                    </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> k=dfn[son[x]]+sz[son[x]]; k&lt;dfn[x]+sz[x]; ++k){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">173</span><span>                        </span><span style="color:#5c6370;font-style:italic">//i&#x27;s subtree </span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">174</span><span>                        </span><span style="color:#e6c07b">add</span><span>(dep[seq[k]]-dep[x], </span><span style="color:#d19a66">1</span><span>, </span><span style="color:#d19a66">1</span><span>);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">175</span><span>                        </span><span style="color:#5c6370;font-style:italic">//i&#x27;s father</span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">176</span><span>                        </span><span style="color:#e6c07b">add</span><span>(dep[seq[k]]-dep[i]+</span><span style="color:#d19a66">1</span><span>, </span><span style="color:#d19a66">-1</span><span>, </span><span style="color:#d19a66">1</span><span>);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">177</span>                    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">178</span>                }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">179</span><span>                </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">auto</span><span> t:qry[x]) ans[t.id]+=t.mul*</span><span style="color:#e6c07b">get</span><span>(t.k);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">180</span>            }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">181</span><span>            </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">auto</span><span> t:back) </span><span style="color:#e6c07b">add</span><span>(t.fi, t.se, </span><span style="color:#d19a66">0</span><span>);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">182</span><span>            back.</span><span style="color:#e6c07b">clear</span><span>();
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">183</span><span>            </span><span style="color:#5c6370;font-style:italic">//</span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">184</span><span>            </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> j=len[i]</span><span style="color:#d19a66">-1</span><span>; j&gt;</span><span style="color:#d19a66">0</span><span>; --j){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">185</span><span>                </span><span style="color:#c678dd">int</span><span> x=seq[dfn[i]+j];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">186</span><span>                </span><span style="color:#e6c07b">add</span><span>(dep[x]-dep[i], </span><span style="color:#d19a66">1</span><span>, </span><span style="color:#d19a66">1</span><span>);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">187</span><span>                </span><span style="color:#c678dd">if</span><span>(son[x]){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">188</span><span>                    </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> k=dfn[son[x]]+sz[son[x]]; k&lt;dfn[x]+sz[x]; ++k){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">189</span><span>                        </span><span style="color:#e6c07b">add</span><span>(dep[seq[k]]-dep[i], </span><span style="color:#d19a66">1</span><span>, </span><span style="color:#d19a66">1</span><span>);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">190</span>                    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">191</span>                }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">192</span><span>                </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">auto</span><span> t:qry[f[x]]) ans[t.id]+=t.mul*(</span><span style="color:#e6c07b">get</span><span>(t.k+dep[x]-dep[i]</span><span style="color:#d19a66">-1</span><span>)-</span><span style="color:#e6c07b">get</span><span>(t.k</span><span style="color:#d19a66">-1</span><span>));
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">193</span>            }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">194</span><span>            </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">auto</span><span> t:back) </span><span style="color:#e6c07b">add</span><span>(t.fi, t.se, </span><span style="color:#d19a66">0</span><span>);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">195</span><span>            back.</span><span style="color:#e6c07b">clear</span><span>();
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">196</span>        }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">197</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">198</span>}D2;
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">199</span><span></span><span style="color:#c678dd">int</span><span> f[N][</span><span style="color:#d19a66">20</span><span>], dep[N];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">200</span><span></span><span class="hljs-function" style="color:#c678dd">void</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">dfs</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> x, </span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> fa)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">201</span><span>    f[x][</span><span style="color:#d19a66">0</span><span>]=fa; dep[x]=dep[fa]+</span><span style="color:#d19a66">1</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">202</span><span>    </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=</span><span style="color:#d19a66">1</span><span>; i&lt;</span><span style="color:#d19a66">20</span><span>; ++i) f[x][i]=f[f[x][i</span><span style="color:#d19a66">-1</span><span>]][i</span><span style="color:#d19a66">-1</span><span>];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">203</span><span>    </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">auto</span><span> y:e[x]) </span><span style="color:#c678dd">if</span><span>(y^fa){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">204</span><span>        </span><span style="color:#e6c07b">dfs</span><span>(y, x);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">205</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">206</span>}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">207</span><span></span><span class="hljs-function" style="color:#c678dd">inline</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#c678dd">int</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">lca</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> x, </span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> y)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">208</span><span>    </span><span style="color:#c678dd">if</span><span>(dep[x]&lt;dep[y]) </span><span style="color:#e6c07b">swap</span><span>(x, y);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">209</span><span>    </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=</span><span style="color:#d19a66">19</span><span>; i&gt;=</span><span style="color:#d19a66">0</span><span>; --i) </span><span style="color:#c678dd">if</span><span>(dep[f[x][i]]&gt;=dep[y]) x=f[x][i];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">210</span><span>    </span><span style="color:#c678dd">if</span><span>(x==y) </span><span style="color:#c678dd">return</span><span> x;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">211</span><span>    </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=</span><span style="color:#d19a66">19</span><span>; i&gt;=</span><span style="color:#d19a66">0</span><span>; --i) </span><span style="color:#c678dd">if</span><span>(f[x][i]^f[y][i]) x=f[x][i], y=f[y][i];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">212</span><span>    </span><span style="color:#c678dd">return</span><span> f[x][</span><span style="color:#d19a66">0</span><span>];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">213</span>}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">214</span><span></span><span class="hljs-function" style="color:#c678dd">inline</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#c678dd">int</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">dis</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> x, </span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> y)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">215</span><span>    </span><span style="color:#c678dd">return</span><span> dep[x]+dep[y]</span><span style="color:#d19a66">-2</span><span>*dep[</span><span style="color:#e6c07b">lca</span><span>(x, y)];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">216</span>}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">217</span><span></span><span class="hljs-function" style="color:#c678dd">inline</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#c678dd">int</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">jump</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> x, </span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> d)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">218</span><span>    </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=</span><span style="color:#d19a66">19</span><span>; i&gt;=</span><span style="color:#d19a66">0</span><span>; --i) </span><span style="color:#c678dd">if</span><span>((d&gt;&gt;i)&amp;</span><span style="color:#d19a66">1</span><span>){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">219</span>        x=f[x][i];
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">220</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">221</span><span>    </span><span style="color:#c678dd">return</span><span> x;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">222</span>}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">223</span><span></span><span style="color:#c678dd">int</span><span> qtp[N], qx[N], qy[N];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">224</span><span></span><span class="hljs-function" style="color:#c678dd">inline</span><span class="hljs-function"> ll </span><span class="hljs-function" style="color:#61aeee">path_hash</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> x, </span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> y)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">225</span><span>    </span><span style="color:#c678dd">if</span><span>(x&gt;y) </span><span style="color:#e6c07b">swap</span><span>(x, y);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">226</span><span>    </span><span style="color:#c678dd">return</span><span> </span><span style="color:#d19a66">1000000000ll</span><span>*x+y;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">227</span>}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">228</span><span></span><span style="color:#c678dd">int</span><span> px[N], py[N], idx;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">229</span><span>vector&lt;</span><span style="color:#c678dd">int</span><span>&gt; item[N&lt;&lt;</span><span style="color:#d19a66">2</span><span>];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">230</span><span></span><span class="hljs-function" style="color:#c678dd">void</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">ins</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> p, </span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> l, </span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> r, </span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> L, </span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> R, </span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> x)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">231</span><span>    </span><span style="color:#c678dd">if</span><span>(L&lt;=l&amp;&amp;r&lt;=R){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">232</span><span>        item[p].</span><span style="color:#e6c07b">ep</span><span>(x);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">233</span><span>        </span><span style="color:#c678dd">return</span><span> ;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">234</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">235</span><span>    </span><span style="color:#c678dd">int</span><span> mid=(l+r)&gt;&gt;</span><span style="color:#d19a66">1</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">236</span><span>    </span><span style="color:#c678dd">if</span><span>(L&lt;=mid) </span><span style="color:#e6c07b">ins</span><span>(p&lt;&lt;</span><span style="color:#d19a66">1</span><span>, l, mid, L, R, x);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">237</span><span>    </span><span style="color:#c678dd">if</span><span>(R&gt;mid) </span><span style="color:#e6c07b">ins</span><span>(p&lt;&lt;</span><span style="color:#d19a66">1</span><span>|</span><span style="color:#d19a66">1</span><span>, mid+</span><span style="color:#d19a66">1</span><span>, r, L, R, x);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">238</span>}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">239</span><span></span><span class="hljs-class" style="color:#c678dd">struct</span><span class="hljs-class"> </span><span class="hljs-class" style="color:#61aeee">tree_info</span><span class="hljs-class">{</span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">240</span><span>    </span><span style="color:#c678dd">int</span><span> state, px, py, len;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">241</span><span>}info[</span><span style="color:#d19a66">30</span><span>];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">242</span><span></span><span class="hljs-function" style="color:#c678dd">inline</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#c678dd">int</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">fnd</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> x, </span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> y, </span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> z)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">243</span><span>    </span><span style="color:#c678dd">int</span><span> u=</span><span style="color:#e6c07b">lca</span><span>(x, y), v=</span><span style="color:#e6c07b">lca</span><span>(x, z), w=</span><span style="color:#e6c07b">lca</span><span>(y, z);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">244</span><span>    </span><span style="color:#c678dd">if</span><span>(dep[u]&lt;dep[v]) </span><span style="color:#e6c07b">swap</span><span>(u, v);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">245</span><span>    </span><span style="color:#c678dd">if</span><span>(dep[u]&lt;dep[w]) </span><span style="color:#e6c07b">swap</span><span>(u, w);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">246</span><span>    </span><span style="color:#c678dd">return</span><span> u;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">247</span>}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">248</span><span></span><span style="color:#c678dd">inline</span><span> tree_info </span><span style="color:#c678dd">operator</span><span> +(tree_info cur, </span><span style="color:#c678dd">int</span><span> t){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">249</span><span>    </span><span style="color:#c678dd">if</span><span>(cur.state==</span><span style="color:#d19a66">0</span><span>){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">250</span><span>        cur.state=</span><span style="color:#d19a66">1</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">251</span>        cur.px=px[t]; cur.py=py[t];
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">252</span><span>        cur.len=</span><span style="color:#d19a66">0</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">253</span><span>        </span><span style="color:#c678dd">return</span><span> cur;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">254</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">255</span><span>    </span><span style="color:#c678dd">int</span><span> lca1=</span><span style="color:#e6c07b">fnd</span><span>(cur.px, px[t], py[t]), lca2=</span><span style="color:#e6c07b">fnd</span><span>(cur.py, px[t], py[t]);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">256</span><span>    </span><span style="color:#c678dd">if</span><span>(lca1!=lca2){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">257</span><span>        </span><span style="color:#c678dd">if</span><span>(cur.state==</span><span style="color:#d19a66">1</span><span>){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">258</span>            cur.px=lca1; cur.py=lca2;
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">259</span><span>            </span><span style="color:#c678dd">return</span><span> cur;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">260</span>        }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">261</span><span>        </span><span style="color:#c678dd">return</span><span> cur;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">262</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">263</span><span>    </span><span style="color:#c678dd">if</span><span>(cur.state==</span><span style="color:#d19a66">1</span><span>){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">264</span><span>        </span><span style="color:#c678dd">int</span><span> top=</span><span style="color:#e6c07b">fnd</span><span>(cur.px, cur.py, lca1);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">265</span><span>        </span><span style="color:#c678dd">if</span><span>(top==lca1){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">266</span>            cur.px=cur.py=top;
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">267</span><span>            </span><span style="color:#c678dd">return</span><span> cur;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">268</span>        }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">269</span><span>        cur.state=</span><span style="color:#d19a66">2</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">270</span><span>        cur.px=top; cur.py=lca1; cur.len=</span><span style="color:#e6c07b">dis</span><span>(top, lca1);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">271</span><span>        </span><span style="color:#c678dd">return</span><span> cur;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">272</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">273</span><span>    </span><span style="color:#c678dd">int</span><span> d1=</span><span style="color:#e6c07b">dis</span><span>(cur.px, lca1), d2=</span><span style="color:#e6c07b">dis</span><span>(cur.py, lca1);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">274</span><span>    </span><span style="color:#c678dd">if</span><span>(cur.len&gt;=d1&amp;&amp;cur.len&gt;=d2){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">275</span><span>        </span><span style="color:#c678dd">return</span><span> cur;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">276</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">277</span><span>    </span><span style="color:#c678dd">if</span><span>(d1&gt;=d2){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">278</span>        cur.len=d1; cur.py=lca1;
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">279</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">280</span><span>    </span><span style="color:#c678dd">else</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">281</span>        cur.len=d2; cur.px=lca1;
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">282</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">283</span><span>    </span><span style="color:#c678dd">return</span><span> cur;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">284</span>}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">285</span><span></span><span class="hljs-function" style="color:#c678dd">void</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">solve</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> o, </span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> p, </span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> l, </span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> r)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">286</span><span>    </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">auto</span><span> t:item[p]){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">287</span>        info[o]=info[o]+t;
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">288</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">289</span><span>    </span><span style="color:#c678dd">if</span><span>(l==r){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">290</span><span>        </span><span style="color:#c678dd">if</span><span>(qtp[l]!=</span><span style="color:#d19a66">3</span><span>) </span><span style="color:#c678dd">return</span><span> ;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">291</span><span>        </span><span style="color:#c678dd">if</span><span>(info[o].state==</span><span style="color:#d19a66">0</span><span>){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">292</span><span>            ans[l]=</span><span style="color:#d19a66">0</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">293</span><span>            </span><span style="color:#c678dd">return</span><span> ;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">294</span>        }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">295</span><span>        </span><span style="color:#c678dd">if</span><span>(dep[info[o].px]&lt;dep[info[o].py]) </span><span style="color:#e6c07b">swap</span><span>(info[o].px, info[o].py);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">296</span><span>        </span><span style="color:#c678dd">if</span><span>(info[o].state==</span><span style="color:#d19a66">1</span><span>){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">297</span><span>            </span><span style="color:#c678dd">int</span><span> w=</span><span style="color:#e6c07b">lca</span><span>(info[o].px, info[o].py);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">298</span><span>            ans[l]=D1.</span><span style="color:#e6c07b">get</span><span>(w, qx[l]);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">299</span><span>            D2.</span><span style="color:#e6c07b">ins</span><span>(info[o].px, (Neighbors2::node){l, qx[l], </span><span style="color:#d19a66">1</span><span>});
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">300</span><span>            D2.</span><span style="color:#e6c07b">ins</span><span>(info[o].py, (Neighbors2::node){l, qx[l], </span><span style="color:#d19a66">1</span><span>});
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">301</span><span>            D2.</span><span style="color:#e6c07b">ins</span><span>(w, (Neighbors2::node){l, qx[l], </span><span style="color:#d19a66">-2</span><span>});
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">302</span>        }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">303</span><span>        </span><span style="color:#c678dd">else</span><span> {
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">304</span><span>            </span><span style="color:#c678dd">if</span><span>(qx[l]*</span><span style="color:#d19a66">2</span><span>&lt;info[o].len){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">305</span><span>                ans[l]=</span><span style="color:#d19a66">0</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">306</span><span>                </span><span style="color:#c678dd">return</span><span> ;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">307</span>            }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">308</span><span>            </span><span style="color:#c678dd">if</span><span>(info[o].len&amp;</span><span style="color:#d19a66">1</span><span>){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">309</span><span>                </span><span style="color:#c678dd">int</span><span> p1=</span><span style="color:#e6c07b">jump</span><span>(info[o].px, info[o].len/</span><span style="color:#d19a66">2</span><span>), p2=f[p1][</span><span style="color:#d19a66">0</span><span>];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">310</span><span>                ans[l]=D1.</span><span style="color:#e6c07b">get</span><span>(p2, qx[l]-info[o].len/</span><span style="color:#d19a66">2</span><span style="color:#d19a66">-1</span><span>);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">311</span><span>                D2.</span><span style="color:#e6c07b">ins</span><span>(p1, (Neighbors2::node){l, qx[l]-info[o].len/</span><span style="color:#d19a66">2</span><span style="color:#d19a66">-1</span><span>, </span><span style="color:#d19a66">1</span><span>});
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">312</span><span>                D2.</span><span style="color:#e6c07b">ins</span><span>(p2, (Neighbors2::node){l, qx[l]-info[o].len/</span><span style="color:#d19a66">2</span><span style="color:#d19a66">-1</span><span>, </span><span style="color:#d19a66">-1</span><span>});
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">313</span>            }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">314</span><span>            </span><span style="color:#c678dd">else</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">315</span><span>                ans[l]=D1.</span><span style="color:#e6c07b">get</span><span>(</span><span style="color:#e6c07b">jump</span><span>(info[o].px, info[o].len/</span><span style="color:#d19a66">2</span><span>), qx[l]-info[o].len/</span><span style="color:#d19a66">2</span><span>);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">316</span>            }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">317</span>        }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">318</span><span>        </span><span style="color:#c678dd">return</span><span> ;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">319</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">320</span><span>    </span><span style="color:#c678dd">int</span><span> mid=(l+r)&gt;&gt;</span><span style="color:#d19a66">1</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">321</span><span>    info[o+</span><span style="color:#d19a66">1</span><span>]=info[o];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">322</span><span>    </span><span style="color:#e6c07b">solve</span><span>(o+</span><span style="color:#d19a66">1</span><span>, p&lt;&lt;</span><span style="color:#d19a66">1</span><span>, l, mid);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">323</span><span>    info[o+</span><span style="color:#d19a66">1</span><span>]=info[o];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">324</span><span>    </span><span style="color:#e6c07b">solve</span><span>(o+</span><span style="color:#d19a66">1</span><span>, p&lt;&lt;</span><span style="color:#d19a66">1</span><span>|</span><span style="color:#d19a66">1</span><span>, mid+</span><span style="color:#d19a66">1</span><span>, r);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">325</span>}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">326</span><span></span><span class="hljs-function" style="color:#c678dd">void</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">solve</span><span class="hljs-function hljs-params">()</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">327</span><span>    </span><span style="color:#e6c07b">read</span><span>(n); </span><span style="color:#e6c07b">read</span><span>(m);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">328</span><span>    </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=</span><span style="color:#d19a66">1</span><span>; i&lt;=n; ++i) e[i].</span><span style="color:#e6c07b">clear</span><span>();
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">329</span><span>    </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=</span><span style="color:#d19a66">1</span><span>, x, y; i&lt;n; ++i){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">330</span><span>        </span><span style="color:#e6c07b">read</span><span>(x); </span><span style="color:#e6c07b">read</span><span>(y);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">331</span><span>        e[x].</span><span style="color:#e6c07b">ep</span><span>(y); e[y].</span><span style="color:#e6c07b">ep</span><span>(x);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">332</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">333</span><span>    D1.</span><span style="color:#e6c07b">build</span><span>(); D2.</span><span style="color:#e6c07b">build</span><span>();
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">334</span><span>    </span><span style="color:#e6c07b">dfs</span><span>(</span><span style="color:#d19a66">1</span><span>, </span><span style="color:#d19a66">0</span><span>);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">335</span>    unordered_map&lt;ll, vector&lt;pii&gt; &gt; h;
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">336</span><span>    idx=</span><span style="color:#d19a66">0</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">337</span><span>    </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=</span><span style="color:#d19a66">1</span><span>; i&lt;=m*</span><span style="color:#d19a66">4</span><span>; ++i) item[i].</span><span style="color:#e6c07b">clear</span><span>();
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">338</span><span>    </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=</span><span style="color:#d19a66">1</span><span>; i&lt;=m; ++i){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">339</span><span>        </span><span style="color:#e6c07b">read</span><span>(qtp[i]);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">340</span><span>        </span><span style="color:#c678dd">if</span><span>(qtp[i]==</span><span style="color:#d19a66">3</span><span>){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">341</span><span>            </span><span style="color:#e6c07b">read</span><span>(qx[i]);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">342</span><span>            ans[i]=</span><span style="color:#d19a66">0</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">343</span><span>            </span><span style="color:#c678dd">continue</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">344</span>        }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">345</span><span>        </span><span style="color:#e6c07b">read</span><span>(qx[i]); </span><span style="color:#e6c07b">read</span><span>(qy[i]);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">346</span><span>        </span><span style="color:#c678dd">if</span><span>(qtp[i]==</span><span style="color:#d19a66">1</span><span>){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">347</span>            ++idx;
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">348</span>            px[idx]=qx[i]; py[idx]=qy[i];
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">349</span><span>            h[</span><span style="color:#e6c07b">path_hash</span><span>(qx[i], qy[i])].</span><span style="color:#e6c07b">ep</span><span>(idx, i);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">350</span>        }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">351</span><span>        </span><span style="color:#c678dd">else</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">352</span><span>            pii tem=h[</span><span style="color:#e6c07b">path_hash</span><span>(qx[i], qy[i])].</span><span style="color:#e6c07b">back</span><span>();
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">353</span><span>            h[</span><span style="color:#e6c07b">path_hash</span><span>(qx[i], qy[i])].</span><span style="color:#e6c07b">pop_back</span><span>();
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">354</span><span>            </span><span style="color:#e6c07b">ins</span><span>(</span><span style="color:#d19a66">1</span><span>, </span><span style="color:#d19a66">1</span><span>, m, tem.se, i, tem.fi);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">355</span>        }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">356</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">357</span><span>    </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">auto</span><span> t:h){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">358</span><span>        </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">auto</span><span> tt:t.se){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">359</span><span>            </span><span style="color:#e6c07b">ins</span><span>(</span><span style="color:#d19a66">1</span><span>, </span><span style="color:#d19a66">1</span><span>, m, tt.se, m, tt.fi);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">360</span>        }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">361</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">362</span><span>    info[</span><span style="color:#d19a66">0</span><span>].state=</span><span style="color:#d19a66">0</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">363</span><span>    </span><span style="color:#e6c07b">solve</span><span>(</span><span style="color:#d19a66">0</span><span>, </span><span style="color:#d19a66">1</span><span>, </span><span style="color:#d19a66">1</span><span>, m);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">364</span><span>    D2.</span><span style="color:#e6c07b">solve</span><span>();
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">365</span><span>    </span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=</span><span style="color:#d19a66">1</span><span>; i&lt;=m; ++i) </span><span style="color:#c678dd">if</span><span>(qtp[i]==</span><span style="color:#d19a66">3</span><span>){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">366</span><span>        </span><span style="color:#e6c07b">printf</span><span>(</span><span style="color:#98c379">&quot;%d\n&quot;</span><span>, ans[i]);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">367</span>    }
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">368</span>}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">369</span><span></span><span class="hljs-function" style="color:#c678dd">int</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">main</span><span class="hljs-function hljs-params">()</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">370</span><span>	</span><span style="color:#5c6370;font-style:italic">// freopen(&quot;D:\\nya\\acm\\A\\test.in&quot;,&quot;r&quot;,stdin);</span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">371</span><span>	</span><span style="color:#5c6370;font-style:italic">// freopen(&quot;D:\\nya\\acm\\A\\test.out&quot;,&quot;w&quot;,stdout);</span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">372</span><span>	</span><span style="color:#e6c07b">read</span><span>(T);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">373</span><span>	</span><span style="color:#c678dd">while</span><span>(T--){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">374</span><span>		</span><span style="color:#e6c07b">solve</span><span>();
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">375</span>	}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">376</span><span>	</span><span style="color:#c678dd">return</span><span> </span><span style="color:#d19a66">0</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">377</span>}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">378</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">379</span></code></pre></div></div></div></div><div class="flex-shrink-0 basis-1/5 space-y-2 overflow-auto"><div class="overflow-auto"><h2 class="px-1 py-1 text-sm font-medium text-gray-300">File</h2><div class="rounded border-2 border-gray-400 bg-black/80 px-2 py-3 font-mono text-sm text-green-300"><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Name<!-- -->]</span> <span class="text-green-200">code.cpp</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Size<!-- -->]</span> <span class="text-yellow-400">10.29 KB</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Submission Id<!-- -->]</span> <span class="text-green-200">#1426373</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Problem Name<!-- -->]</span> <span class="text-green-200">Ald</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Status<!-- -->]</span> <span class="text-green-200">AC</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Time<!-- -->]</span> <span class="text-yellow-400">1004ms</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Memory<!-- -->]</span> <span class="text-yellow-400">101644kb</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Language<!-- -->]</span> <span class="text-green-200">C++20</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Submit Time<!-- -->]</span> <span class="text-pink-400">2025/10/01 16:31:14</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Submission Link<!-- -->]</span> <a href="https://qoj.ac/submission/1426373" target="_blank" rel="noopener noreferrer" class="text-indigo-400 underline hover:text-indigo-200">https://qoj.ac/submission/1426373</a></div></div></div><div class="overflow-auto"><h2 class="px-1 py-1 text-sm font-medium text-gray-300">Problem</h2><div class="rounded border-2 border-gray-400 bg-black/80 px-2 py-3 font-mono text-sm text-green-300"><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Name<!-- -->]</span> <span class="text-green-200">Ald</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Link<!-- -->]</span> <a href="https://qoj.ac/contest/1376/problem/7507" target="_blank" rel="noopener noreferrer" class="text-indigo-400 underline hover:text-indigo-200">https://qoj.ac/contest/1376/problem/7507</a></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Time Limit<!-- -->]</span> <span class="text-yellow-400">4 s</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Memory Limit<!-- -->]</span> <span class="text-yellow-400">512 MB</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Solved<!-- -->]</span> <span class="text-cyan-400">true</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Submit Time<!-- -->]</span> <span class="text-pink-400">2025/10/01 16:31:14</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Solve Time<!-- -->]</span> <span class="text-pink-400">2025/10/01 16:31:14</span></div></div></div><div class="overflow-auto"><h2 class="px-1 py-1 text-sm font-medium text-gray-300">Contest</h2><div class="rounded border-2 border-gray-400 bg-black/80 px-2 py-3 font-mono text-sm text-green-300"><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Name<!-- -->]</span> <span class="text-green-200">Petrozavodsk Summer 2023. Day 7. PKU Contest</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Date<!-- -->]</span> <span class="text-pink-400">2025-09-28</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Platform<!-- -->]</span> <span class="text-green-200">qoj</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Start Time<!-- -->]</span> <span class="text-pink-400">2025/09/28 09:14:51</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->End Time<!-- -->]</span> <span class="text-pink-400">2025/09/28 14:14:51</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Link<!-- -->]</span> <a href="https://qoj.ac/contest/1376" target="_blank" rel="noopener noreferrer" class="text-indigo-400 underline hover:text-indigo-200">https://qoj.ac/contest/1376</a></div></div></div></div></main></div></div><!--$--><!--/$--><footer class="my-4"><p class="mt-0 border-t border-gray-700 pt-4 text-center text-sm text-gray-400"> 2025 Training Archive <!-- --> <a href="https://github.com/appleblue17/Training-Archive/" target="_blank" rel="noopener noreferrer" class="hover:text-blue-300"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="mr-1 inline" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg>GitHub</a> <!-- --> MIT License</p><p class="mt-2 text-center text-sm text-gray-400">Designed and developed by<a href="https://github.com/Appleblue17" target="_blank" rel="noopener noreferrer" class="px-1 text-blue-400 hover:text-blue-300">Appleblue17</a></p><p class="mt-2 text-center text-xs text-gray-500">Disclaimer: This project is for educational purposes only. Use at your own risk.</p></footer><script src="/Training-Archive/_next/static/chunks/webpack-12683b4c0beed4e8.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[8521,[],\"\"]\n3:I[1661,[],\"\"]\na:I[939,[],\"\"]\n:HL[\"/Training-Archive/_next/static/media/cc27cf3ff100ea21-s.p.ttf\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/ttf\"}]\n:HL[\"/Training-Archive/_next/static/css/f46a16dd4ad90ea1.css\",\"style\"]\n:HL[\"/Training-Archive/_next/static/css/9f4210e542df69af.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"7MBbGvaYym9JmYuGzqZKq\",\"p\":\"/Training-Archive\",\"c\":[\"\",\"view\",\"contests\",\"2025-09-28%20Petrozavodsk%20Summer%202023.%20Day%207.%20PKU%20Contest\",\"problems\",\"G\",\"code.cpp\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"view\",{\"children\":[\"contests\",{\"children\":[[\"contest\",\"2025-09-28%20Petrozavodsk%20Summer%202023.%20Day%207.%20PKU%20Contest\",\"d\"],{\"children\":[\"problems\",{\"children\":[[\"problem\",\"G\",\"d\"],{\"children\":[[\"file\",\"code.cpp\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]}]}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/Training-Archive/_next/static/css/f46a16dd4ad90ea1.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"meta\",null,{\"charSet\":\"UTF-8\"}],[\"$\",\"meta\",null,{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/png\",\"href\":\"https://appleblue17.github.io/Training-Archive/archive-bot.png\"}],[\"$\",\"title\",null,{\"children\":\"Training Archive\"}]]}],[\"$\",\"body\",null,{\"className\":\"__className_e3f162 antialiased\",\"children\":[[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}],[\"$\",\"footer\",null,{\"className\":\"my-4\",\"children\":[[\"$\",\"p\",null,{\"className\":\"mt-0 border-t border-gray-700 pt-4 text-center text-sm text-gray-400\",\"children\":[\" 2025 Training Archive \",\" \",[\"$\",\"a\",null,{\"href\":\"https://github.com/appleblue17/Training-Archive/\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"hover:text-blue-300\",\"children\":[[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"none\",\"strokeWidth\":\"2\",\"viewBox\":\"0 0 24 24\",\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"mr-1 inline\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22\",\"children\":[]}]]],\"style\":{\"color\":\"$undefined\"},\"height\":\"1em\",\"width\":\"1em\",\"xmlns\":\"http://www.w3.org/2000/svg\"}],\"GitHub\"]}],\" \",\" MIT License\"]}],[\"$\",\"p\",null,{\"className\":\"mt-2 text-center text-sm text-gray-400\",\"children\":[\"Designed and developed by\",[\"$\",\"a\",null,{\"href\":\"https://github.com/Appleblue17\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"px-1 text-blue-400 hover:text-blue-300\",\"children\":\"Appleblue17\"}]]}],[\"$\",\"p\",null,{\"className\":\"mt-2 text-center text-xs text-gray-500\",\"children\":\"Disclaimer: This project is for educational purposes only. Use at your own risk.\"}]]}]]}]]}]]}],{\"children\":[\"view\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"contests\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"contest\",\"2025-09-28%20Petrozavodsk%20Summer%202023.%20Day%207.%20PKU%20Contest\",\"d\"],\"$L4\",{\"children\":[\"problems\",\"$L5\",{\"children\":[[\"problem\",\"G\",\"d\"],\"$L6\",{\"children\":[[\"file\",\"code.cpp\",\"d\"],\"$L7\",{\"children\":[\"__PAGE__\",\"$L8\",{},null,false]},null,false]},null,false]},null,false]},null,false]},null,false]},null,false]},null,false],\"$L9\",false]],\"m\":\"$undefined\",\"G\":[\"$a\",[]],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"c:I[7055,[],\"OutletBoundary\"]\ne:I[9909,[],\"AsyncMetadataOutlet\"]\n10:I[7055,[],\"ViewportBoundary\"]\n12:I[7055,[],\"MetadataBoundary\"]\n13:\"$Sreact.suspense\"\n4:[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]\n5:[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]\n6:[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]\n7:[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]\n8:[\"$\",\"$1\",\"c\",{\"children\":[\"$Lb\",[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/Training-Archive/_next/static/css/9f4210e542df69af.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"$Lc\",null,{\"children\":[\"$Ld\",[\"$\",\"$Le\",null,{\"promise\":\"$@f\"}]]}]]}]\n9:[\"$\",\"$1\",\"h\",{\"children\":[null,[[\"$\",\"$L10\",null,{\"children\":\"$L11\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]],[\"$\",\"$L12\",null,{\"children\":[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$13\",null,{\"fallback\":null,\"children\":\"$L14\"}]}]}]]}]\n"])</script><script>self.__next_f.push([1,"15:I[2236,[\"215\",\"static/chunks/1951f239-e4c7a40f4938f7cd.js\",\"903\",\"static/chunks/903-580aa120588c94fd.js\",\"314\",\"static/chunks/314-bdd16cf32a728af3.js\",\"947\",\"static/chunks/app/view/contests/%5Bcontest%5D/problems/%5Bproblem%5D/%5Bfile%5D/page-45187987e20c318a.js\"],\"\"]\n16:I[6417,[\"215\",\"static/chunks/1951f239-e4c7a40f4938f7cd.js\",\"903\",\"static/chunks/903-580aa120588c94fd.js\",\"314\",\"static/chunks/314-bdd16cf32a728af3.js\",\"947\",\"static/chunks/app/view/contests/%5Bcontest%5D/problems/%5Bproblem%5D/%5Bfile%5D/page-45187987e20c318a.js\"],\"default\"]\n17:T292d,"])</script><script>self.__next_f.push([1,"#include\u003cbits/stdc++.h\u003e\nusing namespace std;\ntypedef long long ll;\ntypedef double dou;\ntypedef pair\u003cint,int\u003e pii;\n#define fi first\n#define se second\n#define mapa make_pair\ntypedef long double ld;\ntypedef unsigned long long ull;\n#define ep emplace_back\ntemplate \u003ctypename T\u003einline void read(T \u0026x){\n\tx=0;char c=getchar();bool f=0;\n\tfor(;c\u003c'0'||c\u003e'9';c=getchar()) f|=(c=='-');\n\tfor(;c\u003e='0'\u0026\u0026c\u003c='9';c=getchar())\n\tx=(x\u003c\u003c1)+(x\u003c\u003c3)+(c^48);\n\tx=(f?-x:x);\n}\nconst int N=1e5+5;\nint T, n, m;\nint ans[N];\nvector\u003cint\u003e e[N];\nstruct Neighbors{\n    bool v[N];\n    int get_s(int x, int fa){\n        if(v[x]) return 0;\n        int ret=1;\n        for(auto y:e[x]) if(y!=fa) \n            ret+=get_s(y, x);\n        return ret;\n    }\n    int get_rt(int x, int fa, int siz, int \u0026rt){\n        if(v[x]) return 0;\n        int sum=1, mx=0;\n        for(auto y:e[x]){\n            if(y==fa) continue;\n            int t=get_rt(y, x, siz, rt);\n            mx=max(mx,t); sum+=t;\n        }\n        mx=max(mx, siz-sum);\n        if(mx\u003c=siz/2) rt=x;\n        return sum;\n    }\n    int rt, fa[N];\n    void devide(int x){\n        v[x]=1;\n        for(auto y:e[x]){\n            if(v[y]) continue;\n            int nrt=-1;\n            get_rt(y, -1, get_s(y, -1), nrt); devide(nrt); fa[nrt]=x;\n        }\n    }\n    int dfn, st[20][N\u003c\u003c1], pos[N], lg[N\u003c\u003c1], dep[N];\n    void dis_pre(int x, int fa, int cd){\n        st[0][++dfn]=x; pos[x]=dfn; dep[x]=cd;\n        for(auto y:e[x]){\n            if(y==fa) continue;\n            dis_pre(y, x, cd+1);\n            st[0][++dfn]=x;\n        }\n    }\n    void lca_pre(){\n        for(int i=2; i\u003c=dfn; i++) lg[i]=lg[i\u003e\u003e1]+1;\n        for(int i=1; i\u003c=lg[dfn]; i++){\n            for(int j=1; j+(1\u003c\u003ci)-1\u003c=dfn; j++){\n                st[i][j]=dep[st[i-1][j]]\u003cdep[st[i-1][j+(1\u003c\u003c(i-1))]]?\n                st[i-1][j]:st[i-1][j+(1\u003c\u003c(i-1))];\n            }\n        }\n    }\n    int lca(int x, int y){\n        x=pos[x], y=pos[y];\n        if(x\u003ey) swap(x, y);\n        int t=lg[y-x+1];\n        return dep[st[t][x]]\u003cdep[st[t][y-(1\u003c\u003ct)+1]]?\n        st[t][x]:st[t][y-(1\u003c\u003ct)+1];\n    } \n    int get_dis(int x, int y){\n        return dep[x]+dep[y]-2*dep[lca(x, y)];\n    }\n    vector\u003cint\u003e item[2][N];\n    void ins(int x){\n        for(int i=x; i; i=fa[i]){\n            item[0][i].ep(get_dis(x, i));\n            if(fa[i]) {\n                item[1][i].ep(get_dis(x, fa[i]));\n            }\n        }\n    }\n    int get(int x, int k){\n        int ret=0;\n        int pre=0;\n        for(int i=x; i; pre=i, i=fa[i]){\n            int len=k-get_dis(x, i);\n            if(len\u003c0) continue;\n            ret+=upper_bound(item[0][i].begin(), item[0][i].end(), len)-item[0][i].begin();\n            if(pre) ret-=upper_bound(item[1][pre].begin(), item[1][pre].end(), len)-item[1][pre].begin();\n        }\n        return ret;\n    }\n    void build(){\n        dfn=0;\n        for(int i=1; i\u003c=n; ++i) v[i]=0, item[0][i].clear(), item[1][i].clear();\n        get_rt(1, -1, n, rt);\n        fa[rt]=0;\n        devide(rt);\n        dis_pre(rt, -1, 1);\n        lca_pre();\n        for(int i=1; i\u003c=n; ++i) ins(i);\n        for(int i=1; i\u003c=n; ++i) sort(item[0][i].begin(), item[0][i].end()), sort(item[1][i].begin(), item[1][i].end());\n    }\n}D1;\nstruct Neighbors2{\n    struct node{\n        int id, k, mul;\n    };\n    int dfn[N], son[N], seq[N], top[N], len[N], sz[N], f[N], dep[N];\n    int timer;\n    vector\u003cnode\u003e qry[N];\n    void dfs(int x, int fa){\n        f[x]=fa; sz[x]=1; son[x]=0; dep[x]=dep[fa]+1;\n        for(auto y:e[x]) if(y^fa){\n            dfs(y, x);\n            sz[x]+=sz[y];\n            if(sz[y]\u003esz[son[x]]) son[x]=y;\n        }\n    }\n    void dfs2(int x, int tp){\n        top[x]=tp; ++len[tp]; dfn[x]=++timer; seq[timer]=x;\n        if(son[x]) dfs2(son[x], tp);\n        for(auto y:e[x]) if(y!=f[x]\u0026\u0026y!=son[x]){\n            len[y]=0;\n            dfs2(y, y);\n        }\n    }\n    void build(){\n        for(int i=1; i\u003c=n; ++i) qry[i].clear();\n        timer=0;\n        dfs(1, 0);\n        len[1]=0;\n        dfs2(1, 1);\n    }\n    void ins(int x, node tem){\n        while(x){\n            qry[x].ep(tem);\n            x=f[top[x]];\n        }\n    }\n    int tr[N\u003c\u003c1];\n    vector\u003cpii\u003e back;\n    void add(int x, int v, bool flag){\n        if(flag) back.ep(x, -v);\n        ++x;\n        for(; x\u003c=n*2; x+=(x\u0026-x)) tr[x]+=v;\n    }\n    int get(int x){\n        int ret=0;\n        for(x=min(x+1, n*2); x\u003e0; x-=(x\u0026-x)) ret+=tr[x];\n        return ret;\n    }\n    void solve(){\n        //calculated at lca exactly once\n        for(int i=1; i\u003c=n; ++i) if(i==top[i]){\n            //\n            for(int j=0; j\u003clen[i]; ++j){\n                int x=seq[dfn[i]+j];\n                //i's subtree \n                add(0, 1, 1); \n                //i's father\n                add(dep[x]-dep[i]+1, -1, 1);\n                if(son[x]){\n                    for(int k=dfn[son[x]]+sz[son[x]]; k\u003cdfn[x]+sz[x]; ++k){\n                        //i's subtree \n                        add(dep[seq[k]]-dep[x], 1, 1);\n                        //i's father\n                        add(dep[seq[k]]-dep[i]+1, -1, 1);\n                    }\n                }\n                for(auto t:qry[x]) ans[t.id]+=t.mul*get(t.k);\n            }\n            for(auto t:back) add(t.fi, t.se, 0);\n            back.clear();\n            //\n            for(int j=len[i]-1; j\u003e0; --j){\n                int x=seq[dfn[i]+j];\n                add(dep[x]-dep[i], 1, 1);\n                if(son[x]){\n                    for(int k=dfn[son[x]]+sz[son[x]]; k\u003cdfn[x]+sz[x]; ++k){\n                        add(dep[seq[k]]-dep[i], 1, 1);\n                    }\n                }\n                for(auto t:qry[f[x]]) ans[t.id]+=t.mul*(get(t.k+dep[x]-dep[i]-1)-get(t.k-1));\n            }\n            for(auto t:back) add(t.fi, t.se, 0);\n            back.clear();\n        }\n    }\n}D2;\nint f[N][20], dep[N];\nvoid dfs(int x, int fa){\n    f[x][0]=fa; dep[x]=dep[fa]+1;\n    for(int i=1; i\u003c20; ++i) f[x][i]=f[f[x][i-1]][i-1];\n    for(auto y:e[x]) if(y^fa){\n        dfs(y, x);\n    }\n}\ninline int lca(int x, int y){\n    if(dep[x]\u003cdep[y]) swap(x, y);\n    for(int i=19; i\u003e=0; --i) if(dep[f[x][i]]\u003e=dep[y]) x=f[x][i];\n    if(x==y) return x;\n    for(int i=19; i\u003e=0; --i) if(f[x][i]^f[y][i]) x=f[x][i], y=f[y][i];\n    return f[x][0];\n}\ninline int dis(int x, int y){\n    return dep[x]+dep[y]-2*dep[lca(x, y)];\n}\ninline int jump(int x, int d){\n    for(int i=19; i\u003e=0; --i) if((d\u003e\u003ei)\u00261){\n        x=f[x][i];\n    }\n    return x;\n}\nint qtp[N], qx[N], qy[N];\ninline ll path_hash(int x, int y){\n    if(x\u003ey) swap(x, y);\n    return 1000000000ll*x+y;\n}\nint px[N], py[N], idx;\nvector\u003cint\u003e item[N\u003c\u003c2];\nvoid ins(int p, int l, int r, int L, int R, int x){\n    if(L\u003c=l\u0026\u0026r\u003c=R){\n        item[p].ep(x);\n        return ;\n    }\n    int mid=(l+r)\u003e\u003e1;\n    if(L\u003c=mid) ins(p\u003c\u003c1, l, mid, L, R, x);\n    if(R\u003emid) ins(p\u003c\u003c1|1, mid+1, r, L, R, x);\n}\nstruct tree_info{\n    int state, px, py, len;\n}info[30];\ninline int fnd(int x, int y, int z){\n    int u=lca(x, y), v=lca(x, z), w=lca(y, z);\n    if(dep[u]\u003cdep[v]) swap(u, v);\n    if(dep[u]\u003cdep[w]) swap(u, w);\n    return u;\n}\ninline tree_info operator +(tree_info cur, int t){\n    if(cur.state==0){\n        cur.state=1;\n        cur.px=px[t]; cur.py=py[t];\n        cur.len=0;\n        return cur;\n    }\n    int lca1=fnd(cur.px, px[t], py[t]), lca2=fnd(cur.py, px[t], py[t]);\n    if(lca1!=lca2){\n        if(cur.state==1){\n            cur.px=lca1; cur.py=lca2;\n            return cur;\n        }\n        return cur;\n    }\n    if(cur.state==1){\n        int top=fnd(cur.px, cur.py, lca1);\n        if(top==lca1){\n            cur.px=cur.py=top;\n            return cur;\n        }\n        cur.state=2;\n        cur.px=top; cur.py=lca1; cur.len=dis(top, lca1);\n        return cur;\n    }\n    int d1=dis(cur.px, lca1), d2=dis(cur.py, lca1);\n    if(cur.len\u003e=d1\u0026\u0026cur.len\u003e=d2){\n        return cur;\n    }\n    if(d1\u003e=d2){\n        cur.len=d1; cur.py=lca1;\n    }\n    else{\n        cur.len=d2; cur.px=lca1;\n    }\n    return cur;\n}\nvoid solve(int o, int p, int l, int r){\n    for(auto t:item[p]){\n        info[o]=info[o]+t;\n    }\n    if(l==r){\n        if(qtp[l]!=3) return ;\n        if(info[o].state==0){\n            ans[l]=0;\n            return ;\n        }\n        if(dep[info[o].px]\u003cdep[info[o].py]) swap(info[o].px, info[o].py);\n        if(info[o].state==1){\n            int w=lca(info[o].px, info[o].py);\n            ans[l]=D1.get(w, qx[l]);\n            D2.ins(info[o].px, (Neighbors2::node){l, qx[l], 1});\n            D2.ins(info[o].py, (Neighbors2::node){l, qx[l], 1});\n            D2.ins(w, (Neighbors2::node){l, qx[l], -2});\n        }\n        else {\n            if(qx[l]*2\u003cinfo[o].len){\n                ans[l]=0;\n                return ;\n            }\n            if(info[o].len\u00261){\n                int p1=jump(info[o].px, info[o].len/2), p2=f[p1][0];\n                ans[l]=D1.get(p2, qx[l]-info[o].len/2-1);\n                D2.ins(p1, (Neighbors2::node){l, qx[l]-info[o].len/2-1, 1});\n                D2.ins(p2, (Neighbors2::node){l, qx[l]-info[o].len/2-1, -1});\n            }\n            else{\n                ans[l]=D1.get(jump(info[o].px, info[o].len/2), qx[l]-info[o].len/2);\n            }\n        }\n        return ;\n    }\n    int mid=(l+r)\u003e\u003e1;\n    info[o+1]=info[o];\n    solve(o+1, p\u003c\u003c1, l, mid);\n    info[o+1]=info[o];\n    solve(o+1, p\u003c\u003c1|1, mid+1, r);\n}\nvoid solve(){\n    read(n); read(m);\n    for(int i=1; i\u003c=n; ++i) e[i].clear();\n    for(int i=1, x, y; i\u003cn; ++i){\n        read(x); read(y);\n        e[x].ep(y); e[y].ep(x);\n    }\n    D1.build(); D2.build();\n    dfs(1, 0);\n    unordered_map\u003cll, vector\u003cpii\u003e \u003e h;\n    idx=0;\n    for(int i=1; i\u003c=m*4; ++i) item[i].clear();\n    for(int i=1; i\u003c=m; ++i){\n        read(qtp[i]);\n        if(qtp[i]==3){\n            read(qx[i]);\n            ans[i]=0;\n            continue;\n        }\n        read(qx[i]); read(qy[i]);\n        if(qtp[i]==1){\n            ++idx;\n            px[idx]=qx[i]; py[idx]=qy[i];\n            h[path_hash(qx[i], qy[i])].ep(idx, i);\n        }\n        else{\n            pii tem=h[path_hash(qx[i], qy[i])].back();\n            h[path_hash(qx[i], qy[i])].pop_back();\n            ins(1, 1, m, tem.se, i, tem.fi);\n        }\n    }\n    for(auto t:h){\n        for(auto tt:t.se){\n            ins(1, 1, m, tt.se, m, tt.fi);\n        }\n    }\n    info[0].state=0;\n    solve(0, 1, 1, m);\n    D2.solve();\n    for(int i=1; i\u003c=m; ++i) if(qtp[i]==3){\n        printf(\"%d\\n\", ans[i]);\n    }\n}\nint main(){\n\t// freopen(\"D:\\\\nya\\\\acm\\\\A\\\\test.in\",\"r\",stdin);\n\t// freopen(\"D:\\\\nya\\\\acm\\\\A\\\\test.out\",\"w\",stdout);\n\tread(T);\n\twhile(T--){\n\t\tsolve();\n\t}\n\treturn 0;\n}\n\n"])</script><script>self.__next_f.push([1,"b:[\"$\",\"div\",null,{\"className\":\"flex min-h-screen justify-center py-4\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto w-4/5\",\"children\":[[\"$\",\"header\",null,{\"className\":\"relative w-full rounded-lg py-2 text-slate-300\",\"children\":[[\"$\",\"$L15\",null,{\"href\":\"/\",\"children\":[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"none\",\"strokeWidth\":\"2\",\"viewBox\":\"0 0 24 24\",\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"absolute -left-10 top-3 size-6 transition-colors hover:text-gray-400\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z\",\"children\":[]}],[\"$\",\"polyline\",\"1\",{\"points\":\"9 22 9 12 15 12 15 22\",\"children\":[]}]]],\"style\":{\"color\":\"$undefined\"},\"height\":\"1em\",\"width\":\"1em\",\"xmlns\":\"http://www.w3.org/2000/svg\"}]}],[\"$\",\"h1\",null,{\"className\":\"text-2xl font-semibold tracking-wide\",\"children\":\"File Viewer\"}],[\"$\",\"p\",null,{\"className\":\"ml-4 mt-2 text-base text-gray-400\",\"children\":[[\"$\",\"span\",null,{\"className\":\"px-2 text-lg text-gray-200\",\"children\":\"/\"}],\"2025-09-28 Petrozavodsk Summer 2023. Day 7. PKU Contest\",[\"$\",\"span\",null,{\"className\":\"px-2 text-lg text-slate-300\",\"children\":\"/\"}],\"G\",[\"$\",\"span\",null,{\"className\":\"px-2 text-lg text-slate-300\",\"children\":\"/\"}],\"code.cpp\"]}],[\"$\",\"div\",null,{\"className\":\"absolute right-8 top-2 flex items-center gap-2\",\"children\":[[\"$\",\"a\",null,{\"href\":\"/Training-Archive/contests/2025-09-28 Petrozavodsk Summer 2023. Day 7. PKU Contest/problems/G/code.cpp\",\"download\":true,\"className\":\"rounded bg-gray-700 px-3 py-1 text-sm text-white hover:bg-gray-600\",\"children\":[[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"none\",\"strokeWidth\":\"2\",\"viewBox\":\"0 0 24 24\",\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"mr-2 inline-block text-base\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\",\"children\":[]}],[\"$\",\"polyline\",\"1\",{\"points\":\"7 10 12 15 17 10\",\"children\":[]}],[\"$\",\"line\",\"2\",{\"x1\":\"12\",\"y1\":\"15\",\"x2\":\"12\",\"y2\":\"3\",\"children\":[]}]]],\"style\":{\"color\":\"$undefined\"},\"height\":\"1em\",\"width\":\"1em\",\"xmlns\":\"http://www.w3.org/2000/svg\"}],\"Download\"]}],[\"$\",\"a\",null,{\"href\":\"/Training-Archive/contests/2025-09-28 Petrozavodsk Summer 2023. Day 7. PKU Contest/problems/G/code.cpp\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"rounded bg-gray-700 px-3 py-1 text-sm text-white hover:bg-gray-600\",\"children\":[[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"none\",\"strokeWidth\":\"2\",\"viewBox\":\"0 0 24 24\",\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"mr-2 inline-block text-base\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\",\"children\":[]}],[\"$\",\"polyline\",\"1\",{\"points\":\"14 2 14 8 20 8\",\"children\":[]}],[\"$\",\"line\",\"2\",{\"x1\":\"16\",\"y1\":\"13\",\"x2\":\"8\",\"y2\":\"13\",\"children\":[]}],[\"$\",\"line\",\"3\",{\"x1\":\"16\",\"y1\":\"17\",\"x2\":\"8\",\"y2\":\"17\",\"children\":[]}],[\"$\",\"polyline\",\"4\",{\"points\":\"10 9 9 9 8 9\",\"children\":[]}]]],\"style\":{\"color\":\"$undefined\"},\"height\":\"1em\",\"width\":\"1em\",\"xmlns\":\"http://www.w3.org/2000/svg\"}],\"Raw File\"]}]]}]]}],[\"$\",\"main\",null,{\"className\":\"mt-4 flex w-full items-start justify-center gap-4\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex-grow\",\"children\":[\"$\",\"$L16\",null,{\"code\":\"$17\",\"ext\":\".cpp\"}]}],\"$L18\"]}]]}]}]\n"])</script><script>self.__next_f.push([1,"18:[\"$\",\"div\",null,{\"className\":\"flex-shrink-0 basis-1/5 space-y-2 overflow-auto\",\"children\":[[\"$\",\"div\",null,{\"className\":\"overflow-auto\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"px-1 py-1 text-sm font-medium text-gray-300\",\"children\":\"File\"}],[\"$\",\"div\",null,{\"className\":\"rounded border-2 border-gray-400 bg-black/80 px-2 py-3 font-mono text-sm text-green-300\",\"children\":[[\"$\",\"div\",\"name\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Name\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-green-200\",\"children\":\"code.cpp\"}]]}],[\"$\",\"div\",\"size\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Size\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-yellow-400\",\"children\":\"10.29 KB\"}]]}],[\"$\",\"div\",\"submission_id\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Submission Id\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-green-200\",\"children\":\"#1426373\"}]]}],[\"$\",\"div\",\"problem_name\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Problem Name\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-green-200\",\"children\":\"Ald\"}]]}],[\"$\",\"div\",\"status\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Status\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-green-200\",\"children\":\"AC\"}]]}],[\"$\",\"div\",\"time\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Time\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-yellow-400\",\"children\":\"1004ms\"}]]}],[\"$\",\"div\",\"memory\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Memory\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-yellow-400\",\"children\":\"101644kb\"}]]}],[\"$\",\"div\",\"language\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Language\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-green-200\",\"children\":\"C++20\"}]]}],[\"$\",\"div\",\"submit_time\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Submit Time\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-pink-400\",\"children\":\"2025/10/01 16:31:14\"}]]}],null,[\"$\",\"div\",\"submission_link\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Submission Link\",\"]\"]}],\" \",[\"$\",\"a\",null,{\"href\":\"https://qoj.ac/submission/1426373\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"text-indigo-400 underline hover:text-indigo-200\",\"children\":\"https://qoj.ac/submission/1426373\"}]]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"overflow-auto\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"px-1 py-1 text-sm font-medium text-gray-300\",\"children\":\"Problem\"}],[\"$\",\"div\",null,{\"className\":\"rounded border-2 border-gray-400 bg-black/80 px-2 py-3 font-mono text-sm text-green-300\",\"children\":[[\"$\",\"div\",\"name\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Name\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-green-200\",\"children\":\"Ald\"}]]}],[\"$\",\"div\",\"link\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Link\",\"]\"]}],\" \",[\"$\",\"a\",null,{\"href\":\"https://qoj.ac/contest/1376/problem/7507\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"text-indigo-400 underline hover:text-indigo-200\",\"children\":\"https://qoj.ac/contest/1376/problem/7507\"}]]}],[\"$\",\"div\",\"time_limit\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Time Limit\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-yellow-400\",\"children\":\"4 s\"}]]}],[\"$\",\"div\",\"memory_limit\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[\"$L19\",\" \",\"$L1a\"]}],\"$L1b\",\"$L1c\",\"$L1d\"]}]]}],\"$L1e\"]}]\n"])</script><script>self.__next_f.push([1,"19:[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Memory Limit\",\"]\"]}]\n1a:[\"$\",\"span\",null,{\"className\":\"text-yellow-400\",\"children\":\"512 MB\"}]\n1b:[\"$\",\"div\",\"solved\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Solved\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-cyan-400\",\"children\":\"true\"}]]}]\n1c:[\"$\",\"div\",\"submit_time\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Submit Time\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-pink-400\",\"children\":\"2025/10/01 16:31:14\"}]]}]\n1d:[\"$\",\"div\",\"solve_time\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Solve Time\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-pink-400\",\"children\":\"2025/10/01 16:31:14\"}]]}]\n"])</script><script>self.__next_f.push([1,"1e:[\"$\",\"div\",null,{\"className\":\"overflow-auto\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"px-1 py-1 text-sm font-medium text-gray-300\",\"children\":\"Contest\"}],[\"$\",\"div\",null,{\"className\":\"rounded border-2 border-gray-400 bg-black/80 px-2 py-3 font-mono text-sm text-green-300\",\"children\":[[\"$\",\"div\",\"name\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Name\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-green-200\",\"children\":\"Petrozavodsk Summer 2023. Day 7. PKU Contest\"}]]}],[\"$\",\"div\",\"date\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Date\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-pink-400\",\"children\":\"2025-09-28\"}]]}],[\"$\",\"div\",\"platform\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Platform\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-green-200\",\"children\":\"qoj\"}]]}],[\"$\",\"div\",\"start_time\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Start Time\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-pink-400\",\"children\":\"2025/09/28 09:14:51\"}]]}],[\"$\",\"div\",\"end_time\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"End Time\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-pink-400\",\"children\":\"2025/09/28 14:14:51\"}]]}],[\"$\",\"div\",\"link\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Link\",\"]\"]}],\" \",[\"$\",\"a\",null,{\"href\":\"https://qoj.ac/contest/1376\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"text-indigo-400 underline hover:text-indigo-200\",\"children\":\"https://qoj.ac/contest/1376\"}]]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"11:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\nd:null\n"])</script><script>self.__next_f.push([1,"f:{\"metadata\":[],\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"14:\"$f:metadata\"\n"])</script></body></html>